"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[122],{122:(e,r,t)=>{t.r(r),t.d(r,{default:()=>h});var i=t(555),o=t(43),n=t(862),a=t(579);const s=()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),window.location.href="/login"},d=()=>(0,a.jsx)("span",{style:{fontSize:28,marginRight:12},children:"\ud83d\udc64"}),l=()=>(0,a.jsx)("span",{style:{fontSize:22,marginRight:10},children:"\ud83d\udce7"}),c=()=>(0,a.jsx)("span",{style:{fontSize:22,marginRight:10},children:"\ud83d\udcc5"}),m=()=>(0,a.jsx)("span",{style:{fontSize:20,marginRight:8},children:"\ud83c\udfe0"}),g=e=>{let{status:r}=e;return(0,a.jsx)("span",{style:{display:"inline-block",padding:"0.2em 0.8em",borderRadius:12,background:"Delivered"===r?"#d4f8e8":"#ffe7ba",color:"Delivered"===r?"#1a7f37":"#b8860b",fontWeight:600,fontSize:"0.95em",marginLeft:8},children:r})};const h=function(){const e=(()=>{try{return JSON.parse(localStorage.getItem("user"))}catch(e){return null}})(),[r,t]=(0,o.useState)(null),[h,p]=(0,o.useState)(null),[f,x]=(0,o.useState)(e),[u,b]=(0,o.useState)([]),[y,j]=(0,o.useState)(!0),[v,S]=(0,o.useState)(null),[w,k]=(0,o.useState)({oldPassword:"",newPassword:""}),[z,R]=(0,o.useState)(""),[A,B]=(0,o.useState)(null);return(0,o.useEffect)(()=>{const e=localStorage.getItem("token");Promise.all([(0,n.$)("/api/auth/me",{headers:{Authorization:"Bearer ".concat(e)}}),(0,n.$)("/api/orders/my",{headers:{Authorization:"Bearer ".concat(e)}})]).then(e=>{let[r,t]=e;x(r),console.log("Orders data from backend:",t),b(Array.isArray(t)?t:[]),j(!1)}).catch(()=>{S("Failed to load profile"),j(!1)})},[]),y?(0,a.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",fontFamily:"Inter, Arial, sans-serif",padding:"0 0.5rem"},children:(0,a.jsxs)("div",{style:{maxWidth:1100,margin:"3rem auto",background:"#fff",borderRadius:20,boxShadow:"0 6px 32px rgba(0,0,0,0.08)",padding:"2.5rem 2rem"},children:[(0,a.jsx)("h2",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:"2rem",letterSpacing:1},children:"User Profile"}),(0,a.jsx)("p",{children:"Loading..."})]})}):v?(0,a.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",fontFamily:"Inter, Arial, sans-serif",padding:"0 0.5rem"},children:(0,a.jsxs)("div",{style:{maxWidth:1100,margin:"3rem auto",background:"#fff",borderRadius:20,boxShadow:"0 6px 32px rgba(0,0,0,0.08)",padding:"2.5rem 2rem"},children:[(0,a.jsx)("h2",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:"2rem",letterSpacing:1},children:"User Profile"}),(0,a.jsx)("p",{style:{color:"red"},children:v})]})}):(0,a.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",fontFamily:"Inter, Arial, sans-serif",padding:"0 0.5rem"},children:[(0,a.jsx)("style",{children:"\n    @media (max-width: 900px) {\n      .profile-columns {\n        flex-direction: column !important;\n      }\n    }\n  "}),(0,a.jsxs)("div",{style:{maxWidth:1100,margin:"3rem auto",background:"#fff",borderRadius:20,boxShadow:"0 6px 32px rgba(0,0,0,0.08)",padding:"2.5rem 2rem",display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"-1.5rem"},children:(0,a.jsx)("button",{onClick:s,style:{background:"#FFD700",color:"#222",fontWeight:700,border:"none",borderRadius:8,padding:"0.7rem 1.5rem",fontSize:"1rem",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:"Logout"})}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",borderBottom:"1px solid #eee",paddingBottom:"1.5rem",marginBottom:"2rem"},children:[(0,a.jsxs)("div",{style:{position:"relative",width:90,height:90},children:[(0,a.jsx)("div",{style:{width:90,height:90,borderRadius:"50%",background:"linear-gradient(135deg, #fffbe6 0%, #ffd700 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:38,fontWeight:700,color:"#b8860b",boxShadow:"0 2px 8px rgba(0,0,0,0.07)"},children:h?(0,a.jsx)("img",{src:h,alt:"profile preview",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):null!==f&&void 0!==f&&f.avatarUrl?(0,a.jsx)("img",{src:f.avatarUrl,alt:"avatar",style:{width:"100%",height:"100%",borderRadius:"50%"}}):null!==f&&void 0!==f&&f.name?f.name[0].toUpperCase():(0,a.jsx)(d,{})}),(0,a.jsxs)("label",{htmlFor:"profile-photo-upload",style:{position:"absolute",bottom:-10,right:-10,background:"#FFD700",borderRadius:"50%",padding:8,boxShadow:"0 2px 8px rgba(0,0,0,0.10)",cursor:"pointer",border:"2px solid #fff"},children:[(0,a.jsx)("span",{role:"img","aria-label":"upload",style:{fontSize:22},children:"\ud83d\udcf7"}),(0,a.jsx)("input",{id:"profile-photo-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{const r=e.target.files[0];r&&(t(r),p(URL.createObjectURL(r)))}})]}),r&&(0,a.jsx)("button",{type:"button",onClick:async()=>{if(!r)return;const e=localStorage.getItem("token"),o=new FormData;o.append("photo",r);try{const r=await(0,n.$)("/api/auth/upload-photo",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:o});r.avatarUrl?(x(e=>(0,i.A)((0,i.A)({},e),{},{avatarUrl:r.avatarUrl})),t(null),p(null),alert("Profile photo updated!")):alert(r.message||"Failed to upload photo.")}catch(a){alert("Error uploading photo.")}},style:{position:"absolute",top:-10,right:-10,background:"#fff",color:"#FFD700",border:"1px solid #FFD700",borderRadius:8,padding:"0.3em 0.7em",fontWeight:600,fontSize:"0.95em",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.07)"},children:"Upload"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:700,fontSize:"1.3rem",marginBottom:4},children:null===f||void 0===f?void 0:f.name}),(0,a.jsxs)("div",{style:{color:"#888",fontSize:"1.05rem",marginBottom:2},children:[(0,a.jsx)(l,{})," ",null===f||void 0===f?void 0:f.email]})]})]}),(0,a.jsxs)("div",{className:"profile-columns",style:{display:"flex",gap:"2rem",flexWrap:"wrap"},children:[(0,a.jsxs)("div",{style:{flex:1,minWidth:320,display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,a.jsxs)("div",{style:{background:"#f7f7fa",borderRadius:14,boxShadow:"0 2px 12px rgba(0,0,0,0.04)",padding:"1.5rem 1.2rem",marginBottom:"1.5rem"},children:[(0,a.jsx)("h3",{style:{fontWeight:600,fontSize:"1.15rem",marginBottom:"1rem"},children:"Profile Details"}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:"1.08rem",marginBottom:12},children:[(0,a.jsx)(d,{})," ",(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Name:"})," ",null===f||void 0===f?void 0:f.name]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:"1.08rem",marginBottom:12},children:[(0,a.jsx)(l,{})," ",(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Email:"})," ",null===f||void 0===f?void 0:f.email]})]}),(null===f||void 0===f?void 0:f.registeredAt)&&(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:"1.08rem",marginBottom:12},children:[(0,a.jsx)(c,{})," ",(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Registered At:"})," ",new Date(f.registeredAt).toLocaleDateString()]})]})]}),(0,a.jsxs)("div",{style:{background:"#f7f7fa",borderRadius:14,boxShadow:"0 2px 12px rgba(0,0,0,0.04)",padding:"1.5rem 1.2rem",marginBottom:"1.5rem"},children:[(0,a.jsx)("h3",{style:{fontWeight:600,fontSize:"1.15rem",marginBottom:"1rem"},children:"Change Password"}),(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),R("");const r=localStorage.getItem("token");try{await(0,n.$)("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(w)});R("Password changed successfully."),k({oldPassword:"",newPassword:""})}catch(t){R(t.message||"Failed to change password.")}},style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,a.jsx)("input",{type:"password",placeholder:"Current Password",value:w.oldPassword,onChange:e=>k(r=>(0,i.A)((0,i.A)({},r),{},{oldPassword:e.target.value})),required:!0,style:{padding:"0.7rem 1rem",borderRadius:8,border:"1px solid #ddd",fontSize:"1rem"}}),(0,a.jsx)("input",{type:"password",placeholder:"New Password",value:w.newPassword,onChange:e=>k(r=>(0,i.A)((0,i.A)({},r),{},{newPassword:e.target.value})),required:!0,style:{padding:"0.7rem 1rem",borderRadius:8,border:"1px solid #ddd",fontSize:"1rem"}}),(0,a.jsx)("button",{type:"submit",style:{background:"#FFD700",color:"#222",fontWeight:600,border:"none",borderRadius:8,padding:"0.8rem 0",fontSize:"1rem",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:"Change Password"})]}),z&&(0,a.jsx)("span",{style:{display:"inline-block",padding:"0.3em 1em",borderRadius:14,background:z.includes("success")?"#d4f8e8":"#ffe7ba",color:z.includes("success")?"#1a7f37":"#b8860b",fontWeight:600,fontSize:"1em",marginTop:8},children:z})]})]}),(0,a.jsx)("div",{style:{flex:1.2,minWidth:320},children:(0,a.jsxs)("div",{style:{background:"#f7f7fa",borderRadius:14,boxShadow:"0 2px 12px rgba(0,0,0,0.04)",padding:"1.5rem 1.2rem",marginBottom:"1.5rem"},children:[(0,a.jsx)("h3",{style:{fontWeight:600,fontSize:"1.15rem",marginBottom:"1rem"},children:"Order History"}),0===u.length?(0,a.jsx)("p",{style:{fontSize:"1.05rem",color:"#888"},children:"No orders yet."}):u.map(e=>{var r;const t=A===(e._id||e.id);return(0,a.jsxs)("div",{style:{marginBottom:"1.2rem",border:"1px solid #FFD700",background:"#fffbe6",borderRadius:12,boxShadow:t?"0 4px 16px rgba(218,165,32,0.10)":"0 1px 4px rgba(0,0,0,0.03)",padding:"1rem 1.2rem",cursor:"pointer",transition:"box-shadow 0.2s"},onClick:()=>B(t?null:e._id||e.id),children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{style:{fontWeight:600},children:[(0,a.jsx)("strong",{children:"Order ID:"})," ",e._id||e.id]}),(0,a.jsx)(g,{status:e.status})]}),(0,a.jsx)("span",{style:{fontSize:18,marginLeft:12},children:t?"\u25b2":"\u25bc"})]}),(0,a.jsx)("div",{style:t?{maxHeight:500,transition:"max-height 0.3s"}:{overflow:"hidden",maxHeight:0,transition:"max-height 0.3s"},children:(0,a.jsxs)("div",{style:{marginTop:10},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:"1.08rem",marginBottom:12},children:[(0,a.jsx)(m,{})," ",(0,a.jsxs)("span",{children:[(0,a.jsx)("strong",{children:"Delivery Address:"})," ",null===(r=e.customer)||void 0===r?void 0:r.address]})]}),(0,a.jsx)("h4",{style:{margin:"1rem 0 0.5rem 0",fontWeight:600},children:"Items:"}),(0,a.jsx)("ul",{style:{paddingLeft:18},children:(e.items||[]).map((e,r)=>(0,a.jsxs)("li",{style:{fontSize:"1rem",marginBottom:4},children:[e.name," x ",e.quantity]},r))})]})})]},e._id||e.id)})]})})]})]})]})}},862:(e,r,t)=>{t.d(r,{$:()=>n});var i=t(555);const o="https://clothing-site-backend.onrender.com";async function n(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=await fetch("".concat(o).concat(e),(0,i.A)({credentials:"include"},r));if(!t.ok)try{const e=await t.json(),r=new Error(e.message||"API error: ".concat(t.status));throw r.data=e,r}catch(n){throw new Error("API error: ".concat(t.status))}return t.json()}}}]);
//# sourceMappingURL=122.a35028b2.chunk.js.map