"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[54],{54:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(43),o=r(60),i=r(579);const s={container:{maxWidth:900,margin:"2rem auto",background:"#fff",borderRadius:16,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",padding:"2rem"},title:{color:"#FFD700",fontWeight:800,fontSize:"2rem",marginBottom:18,textAlign:"center"},empty:{textAlign:"center",color:"#888",fontSize:"1.1rem",padding:"2rem 0"},card:{marginBottom:"1.5rem",border:"1px solid #FFD700",background:"#fffbe6",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.03)",padding:"1rem 1.2rem"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between"},orderId:{fontWeight:600},status:e=>({fontWeight:600,color:"Delivered"===e?"#1a7f37":"#b8860b"}),section:{marginTop:10},meta:{fontSize:"1.08rem",marginBottom:12},itemsTitle:{margin:"1rem 0 0.5rem 0",fontWeight:600},list:{paddingLeft:18,margin:0},listItem:{fontSize:"1rem",marginBottom:4},total:{fontWeight:700,fontSize:"1.1rem",color:"#232F3E",textAlign:"right",marginTop:12},button:{background:"#FFD700",color:"#222",border:"none",borderRadius:8,padding:"0.6rem 1.2rem",fontWeight:700,fontSize:"1rem",cursor:"pointer",marginTop:10},center:{padding:40,textAlign:"center"},error:{padding:40,textAlign:"center",color:"red"},errorDetails:{color:"#8b0000",marginTop:8,fontSize:"0.95rem"},actions:{marginTop:12,display:"flex",justifyContent:"center",gap:12},skeletonCard:{marginBottom:"1.5rem",borderRadius:12,padding:"1rem 1.2rem",background:"linear-gradient(90deg, #f4f4f4 25%, #eaeaea 37%, #f4f4f4 63%)",backgroundSize:"400% 100%",animation:"skeleton-loading 1.4s ease infinite"}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TZS";try{const r=Number(e||0);return new Intl.NumberFormat(void 0,{style:"currency",currency:t}).format(r)}catch(r){return"".concat(t," ").concat(null!==e&&void 0!==e?e:0)}},a=e=>{if(!e)return"";const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleString()},d=e=>String(e||"").toLowerCase().replace(/(^|\s)\w/g,e=>e.toUpperCase()),c=e=>{const t=String(e||"pending").trim().toLowerCase();switch(t){case"confirmed":return{label:"Confirmed",color:"#1a7f37"};case"delivered":return{label:"Delivered",color:"#1a7f37"};case"cancelled":case"canceled":return{label:"Cancelled",color:"#d32f2f"};default:return{label:d(t),color:"#b8860b"}}};function u(){const[e,t]=(0,n.useState)([]),[r,d]=(0,n.useState)(!0),[u,m]=(0,n.useState)(null),[g,h]=(0,n.useState)(0),f=(0,o.Zp)(),v=(0,n.useCallback)(async e=>{const r=localStorage.getItem("token");if(!r)return m("You must be logged in to view orders."),d(!1),void f("/login",{replace:!0});try{var n,o;const s="https://clothing-site-backend.onrender.com",l=r?{Authorization:"Bearer ".concat(r)}:{},a=await fetch("".concat(s,"/api/orders/my"),{headers:l,credentials:"include",signal:e});if(401===a.status||403===a.status)return localStorage.removeItem("token"),m("Your session has expired. Please log in again."),d(!1),void f("/login",{replace:!0});const c=(a.headers.get("content-type")||"").includes("application/json"),u=![204,205].includes(a.status);let g=null;if(u&&c)try{g=await a.json()}catch(i){throw new Error("Failed to parse server response")}if(!a.ok){const e=g&&(g.message||g.error)||"Request failed: ".concat(a.status);throw new Error(e)}const h=Array.isArray(g)?g:Array.isArray(null===(n=g)||void 0===n?void 0:n.orders)?g.orders:Array.isArray(null===(o=g)||void 0===o?void 0:o.data)?g.data:[];t(h),m(null)}catch(s){if(s&&"AbortError"===s.name)return;m((null===s||void 0===s?void 0:s.message)||"Failed to load orders")}finally{null!==e&&void 0!==e&&e.aborted||d(!1)}},[f]);return(0,n.useEffect)(()=>{const e=new AbortController;return d(!0),m(null),v(e.signal),()=>e.abort()},[v,g]),(0,n.useEffect)(()=>{const e=setInterval(()=>{h(e=>e+1)},15e3);return()=>clearInterval(e)},[]),r?(0,i.jsxs)("div",{style:s.container,children:[(0,i.jsx)("h2",{style:s.title,children:"Your Orders"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:s.skeletonCard}),(0,i.jsx)("div",{style:s.skeletonCard}),(0,i.jsx)("div",{style:s.skeletonCard})]})]}):u?(0,i.jsxs)("div",{style:s.container,children:[(0,i.jsx)("h2",{style:s.title,children:"Your Orders"}),(0,i.jsxs)("div",{style:s.error,children:["Failed to load orders",(0,i.jsx)("div",{style:s.errorDetails,children:String(u)}),(0,i.jsx)("div",{style:s.actions,children:(0,i.jsx)("button",{style:s.button,onClick:()=>h(e=>e+1),children:"Retry"})})]})]}):(0,i.jsxs)("div",{style:s.container,children:[(0,i.jsx)("h2",{style:s.title,children:"Your Orders"}),0===e.length?(0,i.jsx)("div",{style:s.empty,children:"No orders found."}):e.map(e=>{var t,r,n,o,d;const u=e._id||e.id,{label:m,color:g}=c(e.status),h=(null===(t=e.customer)||void 0===t?void 0:t.address)||e.shippingAddress||"-",f=(null===(r=e.customer)||void 0===r?void 0:r.phone)||e.contactNumber||e.phone||"-",v=e.orderDate||e.createdAt||e.date,y=e.items||e.orderItems||e.cartItems||[],p=null!==(n=null!==(o=null!==(d=e.total)&&void 0!==d?d:e.totalPrice)&&void 0!==o?o:e.amount)&&void 0!==n?n:0,x=e.currency||"TZS";return(0,i.jsxs)("div",{style:s.card,children:[(0,i.jsxs)("div",{style:s.cardHeader,children:[(0,i.jsxs)("span",{style:s.orderId,children:[(0,i.jsx)("strong",{children:"Order ID:"})," ",u]}),(0,i.jsx)("span",{style:{fontWeight:600,color:g},children:m})]}),(0,i.jsxs)("div",{style:s.section,children:[(0,i.jsxs)("div",{style:s.meta,children:[(0,i.jsx)("strong",{children:"Delivery Address:"})," ",h]}),(0,i.jsxs)("div",{style:s.meta,children:[(0,i.jsx)("strong",{children:"Phone:"})," ",f]}),(0,i.jsxs)("div",{style:s.meta,children:[(0,i.jsx)("strong",{children:"Order Date:"})," ",a(v)]}),(0,i.jsx)("h4",{style:s.itemsTitle,children:"Items:"}),(0,i.jsx)("ul",{style:s.list,children:y.map((e,t)=>{var r;return(0,i.jsxs)("li",{style:s.listItem,children:[(null===e||void 0===e?void 0:e.name)||"Item"," x ",null!==(r=null===e||void 0===e?void 0:e.quantity)&&void 0!==r?r:0]},(null===e||void 0===e?void 0:e._id)||(null===e||void 0===e?void 0:e.id)||"".concat((null===e||void 0===e?void 0:e.name)||"item","-").concat(t))})}),(0,i.jsxs)("div",{style:s.total,children:["Total: ",l(p,x)]})]})]},u)})]})}const m="orders-skeleton-keyframes";if("undefined"!==typeof document&&!document.getElementById(m)){const e=document.createElement("style");e.id=m,e.innerHTML="\n    @keyframes skeleton-loading {\n      0% { background-position: 100% 50%; }\n      100% { background-position: 0 50%; }\n    }\n  ",document.head.appendChild(e)}}}]);
//# sourceMappingURL=54.903594ec.chunk.js.map